import{O as b,S as C,a as E}from"./stats-widget-2bh5fk-S.js";import{S as x,P as A,W as K,L,a as T,C as W}from"./three-loader-3diles-xCgGzQWV.js";import{g as j}from"./lil-gui.module.min-eVeCAemg.js";const o=document.querySelector("#canvas-parent"),u=document.querySelector("#stats-widget"),g=new x,a=new A(45,1,10,1e5),d=new K;d.preserveDrawingBuffer=!0;const D=new W,p=new b(a,o);p.listenToKeyEvents(window);o.appendChild(d.domElement);const s=new C;s.domElement.style.position="absolute";s.domElement.style.top="10px";s.domElement.style.left="10px";o.appendChild(s.domElement);const e=new URLSearchParams(document.location.search),H=document.getElementById("copyright");q();const w=e.get("lat")??35.6586,y=e.get("long")??139.7454,f=e.get("height")??100,n={lat:w,long:y,height:f,googleApiKey:e.get("googleApiKey")??"",reload:v};function v(){e.set("googleApiKey",n.googleApiKey),e.set("lat",n.lat),e.set("long",n.long),e.set("height",n.height),window.history.replaceState({},"","?"+e.toString()),window.location.reload()}let t,m;async function q(){const l=await L.load({url:"https://tile.googleapis.com/v1/3dtiles/root.json",viewport:P(),options:{googleApiKey:e.get("googleApiKey")??"",dracoDecoderPath:"https://cdn.jsdelivr.net/npm/three@0.160.0/examples/jsm/libs/draco",basisTranscoderPath:"https://cdn.jsdelivr.net/npm/three@0.160.0/examples/jsm/libs/basis",pointCloudColoring:T.RGB,maximumScreenSpaceError:e.get("sse")??24}}),{model:c,runtime:r}=l;t=r,h(),g.add(c),g.add(r.getTileBoxes()),m=new E(r.getStats(),{container:u}),u.style.visibility="visible",r.orientToGeocoord({lat:Number(w),long:Number(y),height:Number(f)}),a.translateY(1e3),p.update()}function S(l){const c=D.getDelta();p.update(),t&&t.update(c,a),m&&m.update(),d.render(g,a),s.update(),H.innerHTML=(t==null?void 0:t.getDataAttributions())??"",window.requestAnimationFrame(S)}h();function h(){d.setSize(o.clientWidth,o.clientHeight),t==null||t.setViewport(P()),a.aspect=o.clientWidth/o.clientHeight,a.updateProjectionMatrix()}window.addEventListener("resize",h);function P(){return{width:o.clientWidth,height:o.clientHeight,devicePixelRatio:window.devicePixelRatio}}const i=new j().title("Query params");i.width=300;i.add(n,"lat");i.add(n,"long");i.add(n,"height");i.add(n,"googleApiKey").onFinishChange(l=>{v()});i.add(n,"reload");i.open();S();
